apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: keda-invoker
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: invoker
  pollingInterval:  30                               # Optional. Default: 30 seconds
  cooldownPeriod:   300                              # Optional. Default: 300 seconds
#  idleReplicaCount: 1                                # Optional. Default: ignored, must be less than minReplicaCount
  minReplicaCount:  1                                # Optional. Default: 0
  maxReplicaCount:  10                              # Optional. Default: 100
  fallback:                                          # Optional. Section to specify fallback options
    failureThreshold: 3                              # Mandatory if fallback section is included
    replicas: 3                                      # Mandatory if fallback section is included
  advanced:                                          # Optional. Section to specify advanced options
    restoreToOriginalReplicaCount: false             # Optional. Default: false
#    horizontalPodAutoscalerConfig:                   # Optional. Section to specify HPA related options
#      name: keda-hpa-invoker                         # Optional. Default: keda-hpa-{scaled-object-name}
#      behavior:                                      # Optional. Use to modify HPA's scaling behavior
#        scaleDown:
#          stabilizationWindowSeconds: 300
#          policies:
#            - type: Percent
#              value: 100
#              periodSeconds: 15
  triggers:
    - type: kafka
      metadata:
        bootstrapServers: oaas-kafka-bootstrap.oaas.svc:9092
        consumerGroup: oaas-invoker
#        topic: ...
        lagThreshold: '100'
#        activationLagThreshold: '1'
        offsetResetPolicy: latest
        allowIdleConsumers: 'true'
        scaleToZeroOnInvalidOffset: 'false'
        version: '1.0.0'
